# VulnLab — Penetration Testing Report

**Project:** VulnLab (Flask Vulnerable Web App)  
**Tester:** <Your Name>  
**Date:** 2026-01-15  
**Environment:** Localhost (127.0.0.1), SQLite, Flask

---

## 1) Scope
This assessment targets the VulnLab web application running locally for educational purposes.  
The following areas were tested:
- Authentication (login)
- Input handling (search/comments)
- File upload
- Authorization (profile access)

---

## 2) Setup
1. Install dependencies:
   - `pip install -r requirements.txt`
2. Initialize DB:
   - `python database/init_db.py`
3. Run:
   - `python app.py`
4. App URL:
   - http://127.0.0.1:5000

---

## 3) Findings Summary
| # | Vulnerability | Endpoint | Risk |
|---|--------------|----------|------|
| 1 | SQL Injection (Login bypass) | `/login` | High |
| 2 | Reflected XSS | `/search?q=` | Medium |
| 3 | Stored XSS | `/comments` | High |
| 4 | Insecure File Upload | `/upload` | Medium |
| 5 | IDOR (Broken Access Control) | `/profile?id=` | High |

---

## 4) Detailed Findings

### 4.1 SQL Injection — Login Bypass (High)
**Affected:** `/login`  
**Description:** Login uses unsafe SQL string concatenation allowing authentication bypass.

**Steps to Reproduce:**
1. Open `/login`
2. Enter:
   - Username: `admin' --`
   - Password: `anything`
3. Submit

**Expected Result:** Login should fail  
**Actual Result:** Logged in as admin

**Impact:**
- Unauthorized access to admin session

**Screenshot:** `reports/screenshots/sqli_login.png`

**Recommendation (Fix):**
- Use parameterized queries (prepared statements)
- Hash passwords (bcrypt/argon2)

---

### 4.2 Reflected XSS (Medium)
**Affected:** `/search?q=`  
**Payload:**
- `<script>alert(1)</script>`

**Impact:**
- Attacker can execute JS in victim browser if link is clicked

**Screenshot:** `reports/screenshots/reflected_xss.png`

**Recommendation:**
- Output encode user-controlled values
- Do not render input with `|safe`

---

### 4.3 Stored XSS (High)
**Affected:** `/comments`  
**Payload:**
- `<img src=x onerror=alert(1)>`

**Impact:**
- Persistent execution for all visitors

**Screenshot:** `reports/screenshots/stored_xss.png`

**Recommendation:**
- Escape output by default
- Validate/strip HTML
- Use Content Security Policy (CSP)

---

### 4.4 Insecure File Upload (Medium)
**Affected:** `/upload`  
**Issue:**
- Weak extension filter; files stored publicly with original name

**Impact:**
- Upload of active content (HTML), potential phishing / stored XSS

**Screenshot:** `reports/screenshots/upload.png`

**Recommendation:**
- Validate MIME type and magic bytes
- Randomize filenames
- Store outside web root
- Serve downloads with safe headers

---

### 4.5 IDOR — Broken Access Control (High)
**Affected:** `/profile?id=`  
**Steps:**
1. Visit `/profile?id=1`
2. Change to `/profile?id=2`

**Impact:**
- Unauthorized access to other users’ data

**Screenshot:** `reports/screenshots/idor.png`

**Recommendation:**
- Check authorization: only allow viewing own record unless admin
- Use object-level access control

---

## 5) Conclusion
VulnLab is intentionally insecure for learning. The most critical issues are SQLi, Stored XSS, and IDOR.  
A secure version should implement parameterized queries, output encoding, strong session controls, CSRF protection, and authorization checks.

